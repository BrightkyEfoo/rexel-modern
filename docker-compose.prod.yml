networks:
  rexel-net:
    external: true

volumes:
  app_data:
    driver: local

services:
  # Frontend Application
  frontend:
    image: rexel-frontend-prod:latest
    container_name: rexel-frontend-prod
    restart: unless-stopped
    environment:
      NODE_ENV: production
      PORT: 3000
      HOSTNAME: 0.0.0.0
      
      # API Configuration
      NEXT_PUBLIC_API_URL: ${NEXT_PUBLIC_API_URL}
      NEXT_PUBLIC_APP_NAME: ${NEXT_PUBLIC_APP_NAME:-"Rexel Modern"}
      NEXT_PUBLIC_APP_VERSION: ${NEXT_PUBLIC_APP_VERSION:-"1.0.0"}
      
      # Analytics & Monitoring
      NEXT_PUBLIC_ANALYTICS_ID: ${NEXT_PUBLIC_ANALYTICS_ID}
      NEXT_TELEMETRY_DISABLED: 1
      
      # Features flags
      NEXT_PUBLIC_ENABLE_FEATURES: ${NEXT_PUBLIC_ENABLE_FEATURES}
      
      # Security
      NEXTAUTH_URL: ${NEXTAUTH_URL}
      NEXTAUTH_SECRET: ${NEXTAUTH_SECRET}
      
      # CDN & Assets
      NEXT_PUBLIC_CDN_URL: ${NEXT_PUBLIC_CDN_URL}
      NEXT_PUBLIC_ASSETS_URL: ${NEXT_PUBLIC_ASSETS_URL}
    volumes:
      - app_data:/app/data
    ports:
      - '3000:3000'
    networks:
      - rexel-net
    # healthcheck:
    #   test: ['CMD', 'wget', '--no-verbose', '--tries=1', '--spider', 'http://localhost:3000/api/health']
    #   interval: 30s
    #   timeout: 10s
    #   retries: 3
    #   start_period: 30s 